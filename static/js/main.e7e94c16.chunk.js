(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{102:function(e,t){},118:function(e,t){},120:function(e,t){},138:function(e,t){},164:function(e,t,n){"use strict";n.r(t);var r=n(2),o=n.n(r),a=n(83),c=n(79),s=n(10),i=n(80),l=n.n(i),u=n(82),d=(n(45),n(22)),h=n.n(d),p=n(0);function b(e){var t=e.onSubmit,n=e.currentUser;return Object(p.jsx)("form",{onSubmit:t,children:Object(p.jsxs)("fieldset",{id:"fieldset",children:[Object(p.jsxs)("p",{children:["Sign the guest book, ",n.accountId,"!"]}),Object(p.jsxs)("p",{className:"highlight",children:[Object(p.jsx)("label",{htmlFor:"message",children:"Message:"}),Object(p.jsx)("input",{autoComplete:"off",autoFocus:!0,id:"message",required:!0})]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("label",{htmlFor:"donation",children:"Donation (optional):"}),Object(p.jsx)("input",{autoComplete:"off",defaultValue:"0",id:"donation",max:h()(n.balance).div(Math.pow(10,24)),min:"0",step:"0.01",type:"number"}),Object(p.jsx)("span",{title:"NEAR Tokens",children:"\u24c3"})]}),Object(p.jsx)("button",{type:"submit",children:"Sign"})]})})}function j(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("p",{children:"This app demonstrates a key element of NEAR\u2019s UX: once an app has permission to make calls on behalf of a user (that is, once a user signs in), the app can make calls to the blockhain for them without prompting extra confirmation. So you\u2019ll see that if you don\u2019t include a donation, your message gets posted right to the guest book."}),Object(p.jsx)("p",{children:"But if you do add a donation, then NEAR will double-check that you\u2019re ok with sending money to this app."}),Object(p.jsx)("p",{children:"Go ahead and sign in to try it out!"})]})}function g(e){var t=e.messages;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h2",{children:"Messages"}),t.map((function(e,t){return Object(p.jsxs)("p",{className:e.premium?"is-premium":"",children:[Object(p.jsx)("strong",{children:e.sender}),":",Object(p.jsx)("br",{}),e.text]},t)}))]})}var m=h()(3).times(Math.pow(10,13)).toFixed(),f=function(e){var t=e.contract,n=e.currentUser,r=e.nearConfig,o=e.wallet,a=Object(s.useState)([]),c=Object(u.a)(a,2),i=c[0],l=c[1];Object(s.useEffect)((function(){t.getMessages().then(l)}),[t]);return Object(p.jsxs)("main",{children:[Object(p.jsxs)("header",{children:[Object(p.jsx)("h1",{children:"NEAR Guest Book"}),n?Object(p.jsx)("button",{onClick:function(){o.signOut(),window.location.replace(window.location.origin+window.location.pathname)},children:"Log out"}):Object(p.jsx)("button",{onClick:function(){o.requestSignIn(r.contractName,"NEAR Guest Book")},children:"Log in"})]}),n?Object(p.jsx)(b,{onSubmit:function(e){e.preventDefault();var n=e.target.elements,r=n.fieldset,o=n.message,a=n.donation;r.disabled=!0,t.addMessage({text:o.value},m,h()(a.value||"0").times(Math.pow(10,24)).toFixed()).then((function(){t.getMessages().then((function(e){l(e),o.value="",a.value="0",r.disabled=!1,o.focus()}))}))},currentUser:n}):Object(p.jsx)(j,{}),!!n&&!!i.length&&Object(p.jsx)(g,{messages:i})]})},O=n(81),w=n.n(O),x=n(23);function S(){return(S=Object(c.a)(o.a.mark((function e(){var t,n,r,c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=w()("production"),e.next=3,x.connect(Object(a.a)({deps:{keyStore:new x.keyStores.BrowserLocalStorageKeyStore}},t));case 3:if(n=e.sent,!(r=new x.WalletConnection(n)).getAccountId()){e.next=11;break}return e.t0=r.getAccountId(),e.next=9,r.account().state();case 9:e.t1=e.sent.amount,c={accountId:e.t0,balance:e.t1};case 11:return e.next=13,new x.Contract(r.account(),t.contractName,{viewMethods:["getMessages"],changeMethods:["addMessage"],sender:r.getAccountId()});case 13:return s=e.sent,e.abrupt("return",{contract:s,currentUser:c,nearConfig:t,walletConnection:r});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.nearInitPromise=function(){return S.apply(this,arguments)}().then((function(e){var t=e.contract,n=e.currentUser,r=e.nearConfig,o=e.walletConnection;l.a.render(Object(p.jsx)(f,{contract:t,currentUser:n,nearConfig:r,wallet:o}),document.getElementById("root"))}))},81:function(e,t){var n=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CONTRACT_NAME||"guest-book.testnet";e.exports=function(e){switch(e){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:n,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org"};case"production":case"development":case"testnet":return{networkId:"default",nodeUrl:"https://rpc.testnet.near.org",contractName:n,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org"};case"betanet":return{networkId:"betanet",nodeUrl:"https://rpc.betanet.near.org",contractName:n,walletUrl:"https://wallet.betanet.near.org",helperUrl:"https://helper.betanet.near.org"};case"local":return{networkId:"local",nodeUrl:"http://localhost:3030",keyPath:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).HOME,"/.near/validator_key.json"),walletUrl:"http://localhost:4000/wallet",contractName:n};case"test":case"ci":return{networkId:"shared-test",nodeUrl:"https://rpc.ci-testnet.near.org",contractName:n,masterAccount:"test.near"};case"ci-betanet":return{networkId:"shared-test-staging",nodeUrl:"https://rpc.ci-betanet.near.org",contractName:n,masterAccount:"test.near"};default:throw Error("Unconfigured environment '".concat(e,"'. Can be configured in src/config.js."))}}},93:function(e,t){}},[[164,1,2]]]);
//# sourceMappingURL=main.e7e94c16.chunk.js.map